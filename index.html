<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>Nafuzor Project</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #000000;
            --glass-bg: rgba(28, 28, 30, 0.65);
            --glass-border: rgba(255, 255, 255, 0.12);
            --primary: #0a84ff;
            --success: #30d158;
            --danger: #ff453a;
            --warning: #ffd60a;
            --text-main: #ffffff;
            --text-sec: #8e8e93;
            --card-radius: 20px;
        }

        body {
            margin: 0; padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Outfit', sans-serif;
            background: var(--bg-color);
            background-image: radial-gradient(circle at 50% 0%, #1c1c1e 0%, #000000 80%);
            color: var(--text-main);
            min-height: 100vh;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* Анимация фона */
        .ambient-glow {
            position: fixed; top: -20%; left: -20%; width: 140%; height: 60%;
            background: radial-gradient(circle, rgba(10, 132, 255, 0.15) 0%, rgba(0,0,0,0) 70%);
            pointer-events: none; z-index: 0;
        }

        /* ЗАГРУЗЧИК */
        #loader-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 10000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.5s ease;
        }
        .apple-spinner { width: 40px; height: 40px; position: relative; animation: rotate 1s linear infinite; }
        .spinner-blade {
            position: absolute; left: 44.5%; top: 0; width: 11%; height: 27%;
            border-radius: 50px; background: #8e8e93; transform-origin: 50% 185%;
            animation: fade 1s linear infinite;
        }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes fade { 0% { opacity: 1; } 100% { opacity: 0.25; } }
        .spinner-blade:nth-child(1) { transform: rotate(0deg); animation-delay: -1s; }
        .spinner-blade:nth-child(2) { transform: rotate(30deg); animation-delay: -0.9s; }
        .spinner-blade:nth-child(3) { transform: rotate(60deg); animation-delay: -0.8s; }
        .spinner-blade:nth-child(4) { transform: rotate(90deg); animation-delay: -0.7s; }
        .spinner-blade:nth-child(5) { transform: rotate(120deg); animation-delay: -0.6s; }
        .spinner-blade:nth-child(6) { transform: rotate(150deg); animation-delay: -0.5s; }
        .spinner-blade:nth-child(7) { transform: rotate(180deg); animation-delay: -0.4s; }
        .spinner-blade:nth-child(8) { transform: rotate(210deg); animation-delay: -0.3s; }
        .spinner-blade:nth-child(9) { transform: rotate(240deg); animation-delay: -0.2s; }
        .spinner-blade:nth-child(10) { transform: rotate(270deg); animation-delay: -0.1s; }
        .spinner-blade:nth-child(11) { transform: rotate(300deg); animation-delay: -0.08s; }
        .spinner-blade:nth-child(12) { transform: rotate(330deg); animation-delay: 0s; }
        .loader-text { margin-top: 20px; font-weight: 600; font-size: 1.2rem; opacity: 0; animation: fadeIn 2s forwards; }
        @keyframes fadeIn { to { opacity: 1; } }

        /* СТРУКТУРА СТРАНИЦ */
        #app-container { width: 100%; height: 100vh; position: relative; display: none; opacity: 0; transition: opacity 0.5s ease; z-index: 10; }
        .page {
            width: 100%; height: 100%; position: absolute; top: 0; left: 0;
            padding: 20px 16px 80px 16px; box-sizing: border-box;
            display: flex; flex-direction: column; align-items: center;
            overflow-y: auto; overflow-x: hidden;
            transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1), opacity 0.3s ease;
            background: transparent;
        }
        .page-active { transform: translateX(0); opacity: 1; z-index: 2; pointer-events: auto; }
        .page-hidden-left { transform: translateX(-30%); opacity: 0; z-index: 1; pointer-events: none; }
        .page-hidden-right { transform: translateX(100%); opacity: 0; z-index: 1; pointer-events: none; }

        /* HEADER */
        header { width: 100%; display: flex; justify-content: center; align-items: center; position: relative; height: 44px; margin-bottom: 20px; flex-shrink: 0; }
        h1 { font-size: 17px; font-weight: 600; letter-spacing: -0.4px; margin: 0; }
        .back-btn { position: absolute; left: 0; top: 0; height: 100%; display: flex; align-items: center; color: var(--primary); font-size: 17px; cursor: pointer; gap: 5px; }

        /* UI КОМПОНЕНТЫ */
        .glass-card {
            width: 100%; max-width: 400px;
            background: var(--glass-bg); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border); border-radius: var(--card-radius);
            padding: 20px; margin-bottom: 16px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        /* ПРОФИЛЬ */
        .profile-header { display: flex; align-items: center; gap: 15px; position: relative; }
        .avatar { width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #333, #111); display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: 700; border: 1px solid rgba(255,255,255,0.1); }
        .profile-info { flex: 1; }
        .profile-name { font-size: 1.1rem; font-weight: 700; margin-bottom: 2px; }
        .profile-balance { font-size: 0.9rem; color: var(--text-sec); }
        .balance-val { color: var(--text-main); font-weight: 600; }
        
        .status-badge {
            position: absolute; top: 0; right: 0; padding: 6px 12px; border-radius: 20px;
            font-size: 12px; font-weight: 600; text-transform: uppercase;
            backdrop-filter: blur(10px); transition: all 0.3s ease;
        }
        .status-full { background: rgba(48, 209, 88, 0.15); color: var(--success); border: 1px solid rgba(48, 209, 88, 0.3); }
        .status-stop { background: rgba(255, 69, 58, 0.15); color: var(--danger); border: 1px solid rgba(255, 69, 58, 0.3); }

        /* МЕНЮ */
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; width: 100%; max-width: 400px; }
        .menu-btn {
            background: var(--glass-bg); backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border); border-radius: var(--card-radius);
            padding: 16px; min-height: 100px; display: flex; flex-direction: column; justify-content: space-between;
            cursor: pointer; transition: transform 0.1s;
        }
        .menu-btn:active { transform: scale(0.97); background: rgba(255,255,255,0.1); }
        .menu-btn.full { grid-column: span 2; flex-direction: row; align-items: center; min-height: 70px; }
        .menu-icon { width: 32px; height: 32px; border-radius: 10px; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; color: var(--primary); margin-bottom: 10px; }
        .menu-btn.full .menu-icon { margin-bottom: 0; margin-right: 15px; }
        .menu-title { font-weight: 600; font-size: 15px; }
        .menu-desc { font-size: 12px; color: var(--text-sec); margin-top: 4px; }

        /* СПИСКИ И ЭЛЕМЕНТЫ */
        .ios-list { width: 100%; max-width: 400px; background: var(--glass-bg); backdrop-filter: blur(20px); border-radius: 14px; overflow: hidden; margin-bottom: 20px; }
        .ios-item { padding: 16px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.08); font-size: 16px; }
        .ios-item:last-child { border-bottom: none; }
        .ios-label { color: var(--text-sec); }
        .ios-val { font-weight: 500; color: var(--text-main); text-align: right; }

        /* КНОПКИ И ВВОД */
        .action-btn { width: 100%; padding: 16px; background: var(--primary); color: white; border: none; border-radius: 14px; font-size: 16px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .action-btn:active { opacity: 0.8; transform: scale(0.98); }
        .btn-outline { background: transparent; border: 1px solid var(--primary); color: var(--primary); }
        
        .custom-input { width: 100%; padding: 16px; background: rgba(0,0,0,0.3); border: 1px solid var(--glass-border); border-radius: 14px; color: white; font-size: 18px; outline: none; box-sizing: border-box; }
        .custom-input:focus { border-color: var(--primary); }

        .cat-selector { display: flex; gap: 10px; width: 100%; max-width: 400px; margin-bottom: 20px; }
        .cat-btn { flex: 1; padding: 20px; background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 16px; text-align: center; cursor: pointer; transition: 0.2s; }
        .cat-btn.selected { border-color: var(--primary); background: rgba(10, 132, 255, 0.15); }

        /* КОПИРОВАНИЕ */
        .copy-row { display: flex; align-items: center; gap: 10px; background: rgba(0,0,0,0.3); padding: 10px 14px; border-radius: 12px; margin-top: 8px; cursor: pointer; }
        .selectable { user-select: text; -webkit-user-select: text; }
        .toast { position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%) scale(0.9); background: rgba(40,40,40,0.9); backdrop-filter: blur(10px); color: white; padding: 12px 24px; border-radius: 30px; opacity: 0; pointer-events: none; transition: 0.3s; z-index: 2000; box-shadow: 0 10px 40px rgba(0,0,0,0.4); }
        .toast.show { transform: translateX(-50%) scale(1); opacity: 1; }

        /* ДЛЯ ИНСТРУКЦИЙ */
        .sub-accordion { background: rgba(255,255,255,0.05); border-radius: 14px; margin-bottom: 10px; overflow: hidden; }
        .sub-header { padding: 15px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; font-weight: 600; }
        .sub-body { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: rgba(0,0,0,0.2); }
        .sub-body.open { max-height: 500px; }
        .sub-content { padding: 15px; font-size: 14px; color: var(--text-sec); line-height: 1.5; }
        .styled-list { list-style: none; padding: 0; margin: 0; }
        .styled-list li { position: relative; padding-left: 15px; margin-bottom: 8px; }
        .styled-list li::before { content: ''; position: absolute; left: 0; top: 6px; width: 6px; height: 6px; background: var(--primary); border-radius: 50%; }
        .icon-row { display: flex; gap: 10px; margin-bottom: 15px; font-size: 14px; color: var(--text-sec); }
        .video-wrapper { width: 100%; border-radius: 14px; overflow: hidden; margin-bottom: 15px; background: #000; border: 1px solid rgba(255,255,255,0.1); }
        video { width: 100%; display: block; }
    </style>
</head>
<body>

    <div class="ambient-glow"></div>

    <div id="loader-screen">
        <div class="apple-spinner">
            <div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div>
            <div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div>
            <div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div>
            <div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div>
        </div>
        <div class="loader-text">Nafuzor Project</div>
    </div>

    <div id="toast" class="toast"><span>Скопировано</span></div>

    <div id="app-container">

        <!-- ===== ГЛАВНАЯ ===== -->
        <div id="page-home" class="page page-active">
            <header><h1>NAFUZOR PROJECT</h1></header>

            <div class="glass-card">
                <div id="status-badge" class="status-badge status-full">Loading...</div>
                <div class="profile-header">
                    <div id="user-avatar" class="avatar">NP</div>
                    <div class="profile-info">
                        <div id="user-name" class="profile-name">Загрузка...</div>
                        <div class="profile-balance">Баланс: <span id="profile-balance-val" class="balance-val">0 ₽</span></div>
                    </div>
                </div>
            </div>

            <div style="margin-top: 10px; width: 100%; max-width: 400px;">
                <button class="action-btn" onclick="navigateTo('page-menu')">
                    Открыть меню
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg>
                </button>
            </div>
            
            <div style="margin-top: 15px; width: 100%; max-width: 400px; text-align: center;">
                <span class="menu-desc" onclick="navigateTo('page-instructions')" style="text-decoration: underline; cursor:pointer;">Инструкции и помощь</span>
            </div>
        </div>

        <!-- ===== МЕНЮ ===== -->
        <div id="page-menu" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()">
                    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>
                    Назад
                </div>
                <h1>Меню</h1>
            </header>

            <div class="menu-grid">
                <div class="menu-btn" onclick="navigateToAddNumber()">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path></svg></div>
                    <span class="menu-title">Добавить номер</span>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-my-nums')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path></svg></div>
                    <span class="menu-title">Мои номера</span>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-ref')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg></div>
                    <span class="menu-title">Рефералка</span>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-card')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg></div>
                    <span class="menu-title">Карта</span>
                </div>
                <div class="menu-btn full" onclick="navigateTo('page-sub')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path></svg></div>
                    <div>
                        <span class="menu-title">Подписка</span>
                        <div class="menu-desc">Управление тарифом</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== ГЛАВНОЕ МЕНЮ ИНСТРУКЦИЙ (ВОССТАНОВЛЕНО) ===== -->
        <div id="page-instructions" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()">
                    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>
                    Назад
                </div>
                <h1>Инструкции</h1>
            </header>
            
            <div class="menu-grid">
                <div class="menu-btn full" onclick="navigateTo('page-instr-add')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>
                    <div><span class="menu-title">Как добавить номер</span></div>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-instr-subs')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div>
                    <span class="menu-title">Подписки</span>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-instr-ref')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg></div>
                    <span class="menu-title">Рефералка</span>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-instr-card')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg></div>
                    <span class="menu-title">Карта</span>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-instr-limits')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div>
                    <span class="menu-title">Лимиты</span>
                </div>
            </div>
        </div>

        <!-- ИНСТРУКЦИЯ: ДОБАВИТЬ НОМЕР -->
        <div id="page-instr-add" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>Назад</div>
                <h1>Добавление</h1>
            </header>
            <div class="glass-card">
                <div class="video-wrapper">
                    <!-- Замени 'n.mp4' на ссылку на реальное видео, если есть -->
                    <video controls loop muted playsinline><source src="n.mp4" type="video/mp4"></video>
                </div>
                <p style="color:var(--text-sec); font-size:14px;">Пошаговая инструкция:</p>
                <ul class="styled-list">
                    <li>Откройте меню действий.</li>
                    <li>Нажмите "Добавить номер".</li>
                    <li>Выберите категорию (MAX или WhatsApp).</li>
                    <li>Введите номер в указанном формате.</li>
                </ul>
            </div>
        </div>

        <!-- ИНСТРУКЦИЯ: ПОДПИСКИ -->
        <div id="page-instr-subs" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>Назад</div>
                <h1>Подписки</h1>
            </header>
            <div style="width:100%; max-width:400px;">
                <div class="sub-accordion" onclick="toggleSub(this)">
                    <div class="sub-header"><span>Alpha</span> <span>▼</span></div>
                    <div class="sub-body"><div class="sub-content">
                        <p>1 час — 6$<br>Каждые 30 мин — 3$</p>
                    </div></div>
                </div>
                <div class="sub-accordion" onclick="toggleSub(this)">
                    <div class="sub-header"><span>Nucleus</span> <span>▼</span></div>
                    <div class="sub-body"><div class="sub-content">
                        <p>1 час — 9$<br>Каждые 30 мин — 4.5$</p>
                        <p>Автобот включен.</p>
                    </div></div>
                </div>
                <div class="sub-accordion" onclick="toggleSub(this)">
                    <div class="sub-header"><span>Zero Limits</span> <span>▼</span></div>
                    <div class="sub-body"><div class="sub-content">
                        <p>1 час — 15$<br>Каждые 30 мин — 7.5$</p>
                        <p>Максимальная скорость.</p>
                    </div></div>
                </div>
            </div>
        </div>

        <!-- ИНСТРУКЦИЯ: КАРТА -->
        <div id="page-instr-card" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>Назад</div>
                <h1>О Карте</h1>
            </header>
            <div class="glass-card">
                <div class="icon-row"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg> Виртуальная карта для выплат.</div>
                <div class="icon-row"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path></svg> Интеграция с Lixcuk через API.</div>
            </div>
        </div>

        <!-- ИНСТРУКЦИЯ: РЕФЕРАЛКА -->
        <div id="page-instr-ref" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>Назад</div>
                <h1>Рефералка</h1>
            </header>
            <div class="glass-card">
                <p>Получайте 15% с пополнений друзей.</p>
                <p>Ссылка доступна в меню "Рефералка".</p>
            </div>
        </div>

        <!-- ИНСТРУКЦИЯ: ЛИМИТЫ -->
        <div id="page-instr-limits" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>Назад</div>
                <h1>Лимиты</h1>
            </header>
            <div class="glass-card">
                <div class="icon-row" style="color:var(--danger)">Нужен Username (@user).</div>
                <div class="icon-row" style="color:var(--danger)">Нужна подписка на каналы.</div>
            </div>
        </div>


        <!-- ===== ФУНКЦИОНАЛЬНЫЕ СТРАНИЦЫ (ADD, MY NUMS, ETC) ===== -->
        
        <!-- ДОБАВИТЬ НОМЕР -->
        <div id="page-add" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>Назад</div>
                <h1>Добавить номер</h1>
            </header>
            <div class="input-label" style="text-align:center; margin-bottom:15px;">Выберите категорию</div>
            <div class="cat-selector">
                <div class="cat-btn" id="cat-max" onclick="selectCategory('MAX')"><span class="cat-name">MAX</span></div>
                <div class="cat-btn" id="cat-wa" onclick="selectCategory('WhatsApp')"><span class="cat-name">WhatsApp</span></div>
            </div>
            <div id="add-input-container" style="display:none; width: 100%; max-width: 400px;">
                <div class="input-group">
                    <label class="input-label" id="input-label-text">Введите номер</label>
                    <input type="tel" id="phone-input" class="custom-input" placeholder="+7...">
                </div>
                <button class="action-btn" onclick="submitNumber()">Добавить</button>
            </div>
        </div>

        <!-- МОИ НОМЕРА -->
        <div id="page-my-nums" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>Назад</div>
                <h1>Мои номера</h1>
            </header>
            <div class="menu-grid" style="margin-bottom: 20px;">
                <div class="menu-btn" onclick="filterNumbers('work')">
                    <div class="menu-icon" style="color:var(--primary)"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></div><span class="menu-title">В работе</span>
                </div>
                <div class="menu-btn" onclick="filterNumbers('wait')">
                    <div class="menu-icon" style="color:var(--warning)"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><span class="menu-title">Ожидает</span>
                </div>
                <div class="menu-btn" onclick="filterNumbers('success')">
                    <div class="menu-icon" style="color:var(--success)"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><span class="menu-title">Успех</span>
                </div>
                <div class="menu-btn" onclick="filterNumbers('block')">
                    <div class="menu-icon" style="color:var(--danger)"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"></path></svg></div><span class="menu-title">Блок</span>
                </div>
            </div>
            <div id="nums-list" class="ios-list" style="display:none; background:transparent;"></div>
            <div id="nums-empty" style="color: var(--text-sec); text-align: center; margin-top: 20px;">Выберите категорию</div>
        </div>

        <!-- РЕФЕРАЛКА -->
        <div id="page-ref" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>Назад</div>
                <h1>Партнерам</h1>
            </header>
            <div class="glass-card">
                <div style="font-size: 14px; color: var(--text-sec); margin-bottom: 10px;">За каждую покупку друга: <span style="color:var(--success); font-weight:700;">15%</span></div>
                <div class="ios-list" style="margin-bottom: 15px; background: rgba(0,0,0,0.2);">
                    <div class="ios-item"><span class="ios-label">Приглашено:</span><span class="ios-val" id="ref-count">0</span></div>
                </div>
                <div class="input-label">Твоя ссылка:</div>
                <div class="copy-row" onclick="copyRefLink()">
                    <div id="ref-link-text" class="selectable" style="flex:1; font-size:13px; font-family:monospace; color:var(--primary); overflow:hidden; white-space:nowrap;">...</div>
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                </div>
            </div>
            <button class="action-btn" onclick="shareLink()">Поделиться</button>
        </div>

        <!-- КАРТА -->
        <div id="page-card" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>Назад</div>
                <h1>Карта</h1>
            </header>
            <div class="glass-card" style="background: linear-gradient(135deg, #1c1c1e, #000); border: 1px solid rgba(255,255,255,0.15);">
                <div style="display:flex; justify-content:space-between; margin-bottom:20px;"><span style="font-weight:700; font-size:18px;">NAFUZOR</span></div>
                <div style="margin-bottom:15px;">
                    <div style="font-size:12px; color:#888;">Номер карты</div>
    <!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>Nafuzor Project</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #000000;
            --glass-bg: rgba(28, 28, 30, 0.65);
            --glass-border: rgba(255, 255, 255, 0.12);
            --primary: #0a84ff;
            --success: #30d158;
            --danger: #ff453a;
            --warning: #ffd60a;
            --text-main: #ffffff;
            --text-sec: #8e8e93;
            --card-radius: 20px;
        }

        body {
            margin: 0; padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Outfit', sans-serif;
            background: var(--bg-color);
            background-image: radial-gradient(circle at 50% 0%, #1c1c1e 0%, #000000 80%);
            color: var(--text-main);
            min-height: 100vh;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* Анимация фона */
        .ambient-glow {
            position: fixed; top: -20%; left: -20%; width: 140%; height: 60%;
            background: radial-gradient(circle, rgba(10, 132, 255, 0.15) 0%, rgba(0,0,0,0) 70%);
            pointer-events: none; z-index: 0;
        }

        /* ЗАГРУЗЧИК */
        #loader-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 10000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.5s ease;
        }
        .apple-spinner { width: 40px; height: 40px; position: relative; animation: rotate 1s linear infinite; }
        .spinner-blade {
            position: absolute; left: 44.5%; top: 0; width: 11%; height: 27%;
            border-radius: 50px; background: #8e8e93; transform-origin: 50% 185%;
            animation: fade 1s linear infinite;
        }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes fade { 0% { opacity: 1; } 100% { opacity: 0.25; } }
        .spinner-blade:nth-child(1) { transform: rotate(0deg); animation-delay: -1s; }
        .spinner-blade:nth-child(2) { transform: rotate(30deg); animation-delay: -0.9s; }
        .spinner-blade:nth-child(3) { transform: rotate(60deg); animation-delay: -0.8s; }
        .spinner-blade:nth-child(4) { transform: rotate(90deg); animation-delay: -0.7s; }
        .spinner-blade:nth-child(5) { transform: rotate(120deg); animation-delay: -0.6s; }
        .spinner-blade:nth-child(6) { transform: rotate(150deg); animation-delay: -0.5s; }
        .spinner-blade:nth-child(7) { transform: rotate(180deg); animation-delay: -0.4s; }
        .spinner-blade:nth-child(8) { transform: rotate(210deg); animation-delay: -0.3s; }
        .spinner-blade:nth-child(9) { transform: rotate(240deg); animation-delay: -0.2s; }
        .spinner-blade:nth-child(10) { transform: rotate(270deg); animation-delay: -0.1s; }
        .spinner-blade:nth-child(11) { transform: rotate(300deg); animation-delay: -0.08s; }
        .spinner-blade:nth-child(12) { transform: rotate(330deg); animation-delay: 0s; }
        .loader-text { margin-top: 20px; font-weight: 600; font-size: 1.2rem; opacity: 0; animation: fadeIn 2s forwards; }
        @keyframes fadeIn { to { opacity: 1; } }

        /* СТРУКТУРА СТРАНИЦ */
        #app-container { width: 100%; height: 100vh; position: relative; display: none; opacity: 0; transition: opacity 0.5s ease; z-index: 10; }
        .page {
            width: 100%; height: 100%; position: absolute; top: 0; left: 0;
            padding: 20px 16px 80px 16px; box-sizing: border-box;
            display: flex; flex-direction: column; align-items: center;
            overflow-y: auto; overflow-x: hidden;
            transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1), opacity 0.3s ease;
            background: transparent;
        }
        .page-active { transform: translateX(0); opacity: 1; z-index: 2; pointer-events: auto; }
        .page-hidden-left { transform: translateX(-30%); opacity: 0; z-index: 1; pointer-events: none; }
        .page-hidden-right { transform: translateX(100%); opacity: 0; z-index: 1; pointer-events: none; }

        /* HEADER */
        header { width: 100%; display: flex; justify-content: center; align-items: center; position: relative; height: 44px; margin-bottom: 20px; flex-shrink: 0; }
        h1 { font-size: 17px; font-weight: 600; letter-spacing: -0.4px; margin: 0; }
        .back-btn { position: absolute; left: 0; top: 0; height: 100%; display: flex; align-items: center; color: var(--primary); font-size: 17px; cursor: pointer; gap: 5px; }

        /* UI КОМПОНЕНТЫ */
        .glass-card {
            width: 100%; max-width: 400px;
            background: var(--glass-bg); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border); border-radius: var(--card-radius);
            padding: 20px; margin-bottom: 16px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        /* ПРОФИЛЬ */
        .profile-header { display: flex; align-items: center; gap: 15px; position: relative; }
        .avatar { width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #333, #111); display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: 700; border: 1px solid rgba(255,255,255,0.1); }
        .profile-info { flex: 1; }
        .profile-name { font-size: 1.1rem; font-weight: 700; margin-bottom: 2px; }
        .profile-balance { font-size: 0.9rem; color: var(--text-sec); }
        .balance-val { color: var(--text-main); font-weight: 600; }
        
        .status-badge {
            position: absolute; top: 0; right: 0; padding: 6px 12px; border-radius: 20px;
            font-size: 12px; font-weight: 600; text-transform: uppercase;
            backdrop-filter: blur(10px); transition: all 0.3s ease;
        }
        .status-full { background: rgba(48, 209, 88, 0.15); color: var(--success); border: 1px solid rgba(48, 209, 88, 0.3); }
        .status-stop { background: rgba(255, 69, 58, 0.15); color: var(--danger); border: 1px solid rgba(255, 69, 58, 0.3); }

        /* МЕНЮ */
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; width: 100%; max-width: 400px; }
        .menu-btn {
            background: var(--glass-bg); backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border); border-radius: var(--card-radius);
            padding: 16px; min-height: 100px; display: flex; flex-direction: column; justify-content: space-between;
            cursor: pointer; transition: transform 0.1s;
        }
        .menu-btn:active { transform: scale(0.97); background: rgba(255,255,255,0.1); }
        .menu-btn.full { grid-column: span 2; flex-direction: row; align-items: center; min-height: 70px; }
        .menu-icon { width: 32px; height: 32px; border-radius: 10px; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; color: var(--primary); margin-bottom: 10px; }
        .menu-btn.full .menu-icon { margin-bottom: 0; margin-right: 15px; }
        .menu-title { font-weight: 600; font-size: 15px; }
        .menu-desc { font-size: 12px; color: var(--text-sec); margin-top: 4px; }

        /* СПИСКИ И ЭЛЕМЕНТЫ */
        .ios-list { width: 100%; max-width: 400px; background: var(--glass-bg); backdrop-filter: blur(20px); border-radius: 14px; overflow: hidden; margin-bottom: 20px; }
        .ios-item { padding: 16px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.08); font-size: 16px; }
        .ios-item:last-child { border-bottom: none; }
        .ios-label { color: var(--text-sec); }
        .ios-val { font-weight: 500; color: var(--text-main); text-align: right; }

        /* КНОПКИ И ВВОД */
        .action-btn { width: 100%; padding: 16px; background: var(--primary); color: white; border: none; border-radius: 14px; font-size: 16px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .action-btn:active { opacity: 0.8; transform: scale(0.98); }
        .btn-outline { background: transparent; border: 1px solid var(--primary); color: var(--primary); }
        
        .custom-input { width: 100%; padding: 16px; background: rgba(0,0,0,0.3); border: 1px solid var(--glass-border); border-radius: 14px; color: white; font-size: 18px; outline: none; box-sizing: border-box; }
        .custom-input:focus { border-color: var(--primary); }

        .cat-selector { display: flex; gap: 10px; width: 100%; max-width: 400px; margin-bottom: 20px; }
        .cat-btn { flex: 1; padding: 20px; background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 16px; text-align: center; cursor: pointer; transition: 0.2s; }
        .cat-btn.selected { border-color: var(--primary); background: rgba(10, 132, 255, 0.15); }

        /* КОПИРОВАНИЕ */
        .copy-row { display: flex; align-items: center; gap: 10px; background: rgba(0,0,0,0.3); padding: 10px 14px; border-radius: 12px; margin-top: 8px; cursor: pointer; }
        .selectable { user-select: text; -webkit-user-select: text; }
        .toast { position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%) scale(0.9); background: rgba(40,40,40,0.9); backdrop-filter: blur(10px); color: white; padding: 12px 24px; border-radius: 30px; opacity: 0; pointer-events: none; transition: 0.3s; z-index: 2000; box-shadow: 0 10px 40px rgba(0,0,0,0.4); }
        .toast.show { transform: translateX(-50%) scale(1); opacity: 1; }

        /* ДЛЯ ИНСТРУКЦИЙ */
        .sub-accordion { background: rgba(255,255,255,0.05); border-radius: 14px; margin-bottom: 10px; overflow: hidden; }
        .sub-header { padding: 15px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; font-weight: 600; }
        .sub-body { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: rgba(0,0,0,0.2); }
        .sub-body.open { max-height: 500px; }
        .sub-content { padding: 15px; font-size: 14px; color: var(--text-sec); line-height: 1.5; }
        .styled-list { list-style: none; padding: 0; margin: 0; }
        .styled-list li { position: relative; padding-left: 15px; margin-bottom: 8px; }
        .styled-list li::before { content: ''; position: absolute; left: 0; top: 6px; width: 6px; height: 6px; background: var(--primary); border-radius: 50%; }
        .icon-row { display: flex; gap: 10px; margin-bottom: 15px; font-size: 14px; color: var(--text-sec); }
        .video-wrapper { width: 100%; border-radius: 14px; overflow: hidden; margin-bottom: 15px; background: #000; border: 1px solid rgba(255,255,255,0.1); }
        video { width: 100%; display: block; }
    </style>
</head>
<body>

    <div class="ambient-glow"></div>

    <div id="loader-screen">
        <div class="apple-spinner">
            <div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div>
            <div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div>
            <div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div>
            <div class="spinner-blade"></div><div class="spinner-blade"></div><div class="spinner-blade"></div>
        </div>
        <div class="loader-text">Nafuzor Project</div>
    </div>

    <div id="toast" class="toast"><span>Скопировано</span></div>

    <div id="app-container">

        <!-- ===== ГЛАВНАЯ ===== -->
        <div id="page-home" class="page page-active">
            <header><h1>NAFUZOR PROJECT</h1></header>

            <div class="glass-card">
                <div id="status-badge" class="status-badge status-full">Loading...</div>
                <div class="profile-header">
                    <div id="user-avatar" class="avatar">NP</div>
                    <div class="profile-info">
                        <div id="user-name" class="profile-name">Загрузка...</div>
                        <div class="profile-balance">Баланс: <span id="profile-balance-val" class="balance-val">0 ₽</span></div>
                    </div>
                </div>
            </div>

            <div style="margin-top: 10px; width: 100%; max-width: 400px;">
                <button class="action-btn" onclick="navigateTo('page-menu')">
                    Открыть меню
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg>
                </button>
            </div>
            
            <div style="margin-top: 15px; width: 100%; max-width: 400px; text-align: center;">
                <span class="menu-desc" onclick="navigateTo('page-instructions')" style="text-decoration: underline; cursor:pointer;">Инструкции и помощь</span>
            </div>
        </div>

        <!-- ===== МЕНЮ ===== -->
        <div id="page-menu" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()">
                    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>
                    Назад
                </div>
                <h1>Меню</h1>
            </header>

            <div class="menu-grid">
                <div class="menu-btn" onclick="navigateToAddNumber()">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path></svg></div>
                    <span class="menu-title">Добавить номер</span>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-my-nums')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path></svg></div>
                    <span class="menu-title">Мои номера</span>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-ref')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg></div>
                    <span class="menu-title">Рефералка</span>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-card')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg></div>
                    <span class="menu-title">Карта</span>
                </div>
                <div class="menu-btn full" onclick="navigateTo('page-sub')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path></svg></div>
                    <div>
                        <span class="menu-title">Подписка</span>
                        <div class="menu-desc">Управление тарифом</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== ГЛАВНОЕ МЕНЮ ИНСТРУКЦИЙ (ВОССТАНОВЛЕНО) ===== -->
        <div id="page-instructions" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()">
                    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>
                    Назад
                </div>
                <h1>Инструкции</h1>
            </header>
            
            <div class="menu-grid">
                <div class="menu-btn full" onclick="navigateTo('page-instr-add')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>
                    <div><span class="menu-title">Как добавить номер</span></div>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-instr-subs')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div>
                    <span class="menu-title">Подписки</span>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-instr-ref')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg></div>
                    <span class="menu-title">Рефералка</span>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-instr-card')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg></div>
                    <span class="menu-title">Карта</span>
                </div>
                <div class="menu-btn" onclick="navigateTo('page-instr-limits')">
                    <div class="menu-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div>
                    <span class="menu-title">Лимиты</span>
                </div>
            </div>
        </div>

        <!-- ИНСТРУКЦИЯ: ДОБАВИТЬ НОМЕР -->
        <div id="page-instr-add" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>Назад</div>
                <h1>Добавление</h1>
            </header>
            <div class="glass-card">
                <div class="video-wrapper">
                    <!-- Замени 'n.mp4' на ссылку на реальное видео, если есть -->
                    <video controls loop muted playsinline><source src="n.mp4" type="video/mp4"></video>
                </div>
                <p style="color:var(--text-sec); font-size:14px;">Пошаговая инструкция:</p>
                <ul class="styled-list">
                    <li>Откройте меню действий.</li>
                    <li>Нажмите "Добавить номер".</li>
                    <li>Выберите категорию (MAX или WhatsApp).</li>
                    <li>Введите номер в указанном формате.</li>
                </ul>
            </div>
        </div>

        <!-- ИНСТРУКЦИЯ: ПОДПИСКИ -->
        <div id="page-instr-subs" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>Назад</div>
                <h1>Подписки</h1>
            </header>
            <div style="width:100%; max-width:400px;">
                <div class="sub-accordion" onclick="toggleSub(this)">
                    <div class="sub-header"><span>Alpha</span> <span>▼</span></div>
                    <div class="sub-body"><div class="sub-content">
                        <p>1 час — 6$<br>Каждые 30 мин — 3$</p>
                    </div></div>
                </div>
                <div class="sub-accordion" onclick="toggleSub(this)">
                    <div class="sub-header"><span>Nucleus</span> <span>▼</span></div>
                    <div class="sub-body"><div class="sub-content">
                        <p>1 час — 9$<br>Каждые 30 мин — 4.5$</p>
                        <p>Автобот включен.</p>
                    </div></div>
                </div>
                <div class="sub-accordion" onclick="toggleSub(this)">
                    <div class="sub-header"><span>Zero Limits</span> <span>▼</span></div>
                    <div class="sub-body"><div class="sub-content">
                        <p>1 час — 15$<br>Каждые 30 мин — 7.5$</p>
                        <p>Максимальная скорость.</p>
                    </div></div>
                </div>
            </div>
        </div>

        <!-- ИНСТРУКЦИЯ: КАРТА -->
        <div id="page-instr-card" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>Назад</div>
                <h1>О Карте</h1>
            </header>
            <div class="glass-card">
                <div class="icon-row"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg> Виртуальная карта для выплат.</div>
                <div class="icon-row"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path></svg> Интеграция с Lixcuk через API.</div>
            </div>
        </div>

        <!-- ИНСТРУКЦИЯ: РЕФЕРАЛКА -->
        <div id="page-instr-ref" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>Назад</div>
                <h1>Рефералка</h1>
            </header>
            <div class="glass-card">
                <p>Получайте 15% с пополнений друзей.</p>
                <p>Ссылка доступна в меню "Рефералка".</p>
            </div>
        </div>

        <!-- ИНСТРУКЦИЯ: ЛИМИТЫ -->
        <div id="page-instr-limits" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg>Назад</div>
                <h1>Лимиты</h1>
            </header>
            <div class="glass-card">
                <div class="icon-row" style="color:var(--danger)">Нужен Username (@user).</div>
                <div class="icon-row" style="color:var(--danger)">Нужна подписка на каналы.</div>
            </div>
        </div>


        <!-- ===== ФУНКЦИОНАЛЬНЫЕ СТРАНИЦЫ (ADD, MY NUMS, ETC) ===== -->
        
        <!-- ДОБАВИТЬ НОМЕР -->
        <div id="page-add" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>Назад</div>
                <h1>Добавить номер</h1>
            </header>
            <div class="input-label" style="text-align:center; margin-bottom:15px;">Выберите категорию</div>
            <div class="cat-selector">
                <div class="cat-btn" id="cat-max" onclick="selectCategory('MAX')"><span class="cat-name">MAX</span></div>
                <div class="cat-btn" id="cat-wa" onclick="selectCategory('WhatsApp')"><span class="cat-name">WhatsApp</span></div>
            </div>
            <div id="add-input-container" style="display:none; width: 100%; max-width: 400px;">
                <div class="input-group">
                    <label class="input-label" id="input-label-text">Введите номер</label>
                    <input type="tel" id="phone-input" class="custom-input" placeholder="+7...">
                </div>
                <button class="action-btn" onclick="submitNumber()">Добавить</button>
            </div>
        </div>

        <!-- МОИ НОМЕРА -->
        <div id="page-my-nums" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>Назад</div>
                <h1>Мои номера</h1>
            </header>
            <div class="menu-grid" style="margin-bottom: 20px;">
                <div class="menu-btn" onclick="filterNumbers('work')">
                    <div class="menu-icon" style="color:var(--primary)"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></div><span class="menu-title">В работе</span>
                </div>
                <div class="menu-btn" onclick="filterNumbers('wait')">
                    <div class="menu-icon" style="color:var(--warning)"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><span class="menu-title">Ожидает</span>
                </div>
                <div class="menu-btn" onclick="filterNumbers('success')">
                    <div class="menu-icon" style="color:var(--success)"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><span class="menu-title">Успех</span>
                </div>
                <div class="menu-btn" onclick="filterNumbers('block')">
                    <div class="menu-icon" style="color:var(--danger)"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"></path></svg></div><span class="menu-title">Блок</span>
                </div>
            </div>
            <div id="nums-list" class="ios-list" style="display:none; background:transparent;"></div>
            <div id="nums-empty" style="color: var(--text-sec); text-align: center; margin-top: 20px;">Выберите категорию</div>
        </div>

        <!-- РЕФЕРАЛКА -->
        <div id="page-ref" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>Назад</div>
                <h1>Партнерам</h1>
            </header>
            <div class="glass-card">
                <div style="font-size: 14px; color: var(--text-sec); margin-bottom: 10px;">За каждую покупку друга: <span style="color:var(--success); font-weight:700;">15%</span></div>
                <div class="ios-list" style="margin-bottom: 15px; background: rgba(0,0,0,0.2);">
                    <div class="ios-item"><span class="ios-label">Приглашено:</span><span class="ios-val" id="ref-count">0</span></div>
                </div>
                <div class="input-label">Твоя ссылка:</div>
                <div class="copy-row" onclick="copyRefLink()">
                    <div id="ref-link-text" class="selectable" style="flex:1; font-size:13px; font-family:monospace; color:var(--primary); overflow:hidden; white-space:nowrap;">...</div>
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                </div>
            </div>
            <button class="action-btn" onclick="shareLink()">Поделиться</button>
        </div>

        <!-- КАРТА -->
        <div id="page-card" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>Назад</div>
                <h1>Карта</h1>
            </header>
            <div class="glass-card" style="background: linear-gradient(135deg, #1c1c1e, #000); border: 1px solid rgba(255,255,255,0.15);">
                <div style="display:flex; justify-content:space-between; margin-bottom:20px;"><span style="font-weight:700; font-size:18px;">NAFUZOR</span></div>
                <div style="margin-bottom:15px;">
                    <div style="font-size:12px; color:#888;">Номер карты</div>
                    <div class="selectable" id="card-num" style="font-family:monospace; font-size:20px; letter-spacing:2px; margin-top:4px;">****</div>
                </div>
                <div style="display:flex; justify-content:space-between;">
                    <div><div style="font-size:12px; color:#888;">Баланс</div><div id="card-bal" style="font-size:16px; font-weight:600;">0.00 ₽</div></div>
                    <div><div style="font-size:12px; color:#888;">CVV</div><div class="selectable" id="card-cvv" style="font-size:16px; font-weight:600;">***</div></div>
                </div>
                <div style="margin-top:15px; border-top:1px solid rgba(255,255,255,0.1); padding-top:10px; font-size:12px; color:#666;">Активация: <span id="card-date">--.--.--</span></div>
            </div>
            <button class="action-btn btn-outline" onclick="showApiToken()">Показать API токен</button>
        </div>

        <!-- ПОДПИСКА -->
        <div id="page-sub" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>Назад</div>
                <h1>Подписка</h1>
            </header>
            <div class="glass-card" style="text-align:center;">
                <div style="font-size:40px; margin-bottom:10px;">💎</div>
                <div style="font-size:14px; color:var(--text-sec);">Текущая подписка</div>
                <div id="user-sub-name" style="font-size:24px; font-weight:700; color:var(--primary); margin:10px 0;">...</div>
            </div>
        </div>

    </div>

    <script>
        // СЮДА ВСТАВИШЬ ССЫЛКУ ИЗ NGROK ЕСЛИ БУДЕШЬ НАСТРАИВАТЬ
        const API_BASE_URL = ""; 

        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.setHeaderColor('#000000');
        tg.setBackgroundColor('#000000');

        let userData = {
            balanceProfile: 0, referrals: 0, refCode: "",
            card: { number: "...", cvv: "...", balance: 0, date: "...", token: "..." },
            subscription: "None", myNumbers: []
        };
        
        // Тестовые данные на случай, если сервер недоступен (чтобы на телефоне работало)
        const mockData = {
            balance: 0, subscription: "None", ref_count: 0, ref_link: "nafuzor_bot?start=123",
            card: { number: "4400 0000 0000 0000", cvv: "000", balance: 0, date: "01.01.2025", token: "nfz_test" },
            numbers: []
        };

        async function loadData() {
            if (!API_BASE_URL) {
                applyData(mockData); // Нет сервера -> моки
                return;
            }
            try {
                const response = await fetch(`${API_BASE_URL}/api/get_data`, {
                    method: 'GET', headers: { 'Authorization': tg.initData }
                });
                if (!response.ok) throw new Error();
                const data = await response.json();
                applyData(data);
            } catch (error) {
                console.log("Сервер недоступен, используем моки");
                applyData(mockData);
            }
        }

        function applyData(data) {
            userData.balanceProfile = data.balance;
            userData.referrals = data.ref_count;
            userData.refCode = data.ref_link;
            userData.subscription = data.subscription;
            userData.card = data.card;
            userData.myNumbers = data.numbers;
            updateUI();
        }

        function updateUI() {
            document.getElementById('profile-balance-val').innerText = userData.balanceProfile + " ₽";
            document.getElementById('ref-count').innerText = userData.referrals;
            document.getElementById('ref-link-text').innerText = "t.me/" + userData.refCode;
            document.getElementById('user-sub-name').innerText = userData.subscription.charAt(0).toUpperCase() + userData.subscription.slice(1);
            document.getElementById('card-num').innerText = userData.card.number;
            document.getElementById('card-cvv').innerText = userData.card.cvv;
            document.getElementById('card-bal').innerText = userData.card.balance.toFixed(2) + " ₽";
            document.getElementById('card-date').innerText = userData.card.date;
            
            document.getElementById('loader-screen').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('loader-screen').style.display = 'none';
                document.getElementById('app-container').style.display = 'block';
                setTimeout(() => document.getElementById('app-container').style.opacity = '1', 50);
            }, 500);
        }

        // ОТПРАВКА НОМЕРА
        async function submitNumber() {
            const input = document.getElementById('phone-input').value.trim();
            let isValid = (selectedCat === 'MAX') ? /^\+7\d{10}$/.test(input) : /^9\d{9}$/.test(input);

            if (isValid) {
                if (API_BASE_URL) {
                    try {
                        await fetch(`${API_BASE_URL}/api/add_num`, {
                            method: 'POST', headers: {'Authorization': tg.initData, 'Content-Type': 'application/json'},
                            body: JSON.stringify({number: input, cat: selectedCat})
                        });
                        showToast(`Номер ${input} добавлен!`);
                    } catch(e) { showToast("Ошибка сети"); }
                } else {
                    showToast(`Тест: ${input} добавлен`);
                }
                setTimeout(() => goBack(), 1000);
            } else {
                tg.showPopup({title: 'Ошибка', message: `Неверный формат`, buttons: [{type: 'ok'}]});
            }
        }

        function filterNumbers(status) {
            const list = document.getElementById('nums-list');
            const empty = document.getElementById('nums-empty');
            list.innerHTML = '';
            
            let dbStatus = "";
            if(status === 'work') dbStatus = "В работе";
            if(status === 'wait') dbStatus = "Ожидает";
            if(status === 'success') dbStatus = "Успех";
            if(status === 'block') dbStatus = "Блок";

            const filtered = userData.myNumbers.filter(n => n.status === dbStatus);
            
            if (filtered.length > 0) {
                list.style.display = 'block'; empty.style.display = 'none';
                filtered.forEach(n => {
                    let color = '#fff';
                    if(status === 'work') color = '#0a84ff';
                    if(status === 'wait') color = '#ffd60a';
                    if(status === 'success') color = '#30d158';
                    if(status === 'block') color = '#ff453a';
                    const item = document.createElement('div');
                    item.className = 'ios-item';
                    item.innerHTML = `<div style="display:flex; align-items:center; gap:10px;"><div style="width:10px; height:10px; border-radius:50%; background:${color};"></div><span>${n.num}</span></div><span class="ios-label" style="font-size:12px;">${n.cat}</span>`;
                    list.appendChild(item);
                });
            } else {
                list.style.display = 'none'; empty.style.display = 'block';
                empty.innerText = 'В этой категории пусто';
            }
        }

        // УТИЛИТЫ
        function copyRefLink() { navigator.clipboard.writeText("t.me/" + userData.refCode).then(() => showToast("Скопировано")); }
        function shareLink() { tg.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent("https://t.me/" + userData.refCode)}&text=${encodeURIComponent("Заходи в Nafuzor!")}`); }
        function showApiToken() { 
            tg.showPopup({title: 'API Токен', message: userData.card.token, buttons: [{id:'c', type:'default', text:'Копия'},{type:'cancel'}]}, (bid)=>{ if(bid==='c') navigator.clipboard.writeText(userData.card.token); });
        }
        function showToast(text) { const t = document.getElementById('toast'); if(text) t.querySelector('span').innerText = text; t.classList.add('show'); setTimeout(() => t.classList.remove('show'), 2000); }
        function updateStatus() {
            const h = new Date().getHours();
            const b = document.getElementById('status-badge');
            if (h >= 8 && h < 20) { b.innerText = '🟢 Full Work'; b.className = 'status-badge status-full'; }
            else { b.innerText = '🔴 Stop Work'; b.className = 'status-badge status-stop'; }
        }
        function toggleSub(el) {
            const body = el.querySelector('.sub-body');
            const arrow = el.querySelector('.sub-header span:last-child');
            if(body.classList.contains('open')) { body.classList.remove('open'); arrow.innerText='▼'; }
            else { body.classList.add('open'); arrow.innerText='▲'; }
        }

        // НАВИГАЦИЯ
        let selectedCat = null; let historyStack = [];
        function navigateTo(pid) {
            const active = document.querySelector('.page-active'); const target = document.getElementById(pid);
            if(!target || active===target) return;
            active.classList.remove('page-active'); active.classList.add('page-hidden-left');
            target.classList.remove('page-hidden-right'); target.classList.add('page-active');
            historyStack.push(active.id);
        }
        function goBack() {
            if(!historyStack.length) return;
            const pid = historyStack.pop();
            const active = document.querySelector('.page-active'); const prev = document.getElementById(pid);
            active.classList.remove('page-active'); active.classList.add('page-hidden-right');
            prev.classList.remove('page-hidden-left'); prev.classList.add('page-active');
        }
        function navigateToAddNumber() {
            navigateTo('page-add');
            document.getElementById('cat-max').classList.remove('selected');
            document.getElementById('cat-wa').classList.remove('selected');
            document.getElementById('add-input-container').style.display = 'none';
            document.getElementById('phone-input').value = '';
            selectedCat = null;
        }
        function selectCategory(cat) {
            selectedCat = cat;
            document.getElementById('cat-max').classList.remove('selected');
            document.getElementById('cat-wa').classList.remove('selected');
            const l = document.getElementById('input-label-text'); const i = document.getElementById('phone-input');
            if(cat==='MAX'){ document.getElementById('cat-max').classList.add('selected'); l.innerText='Введите номер (+7XXXXXXXXXX)'; i.placeholder='+7999...'; }
            else { document.getElementById('cat-wa').classList.add('selected'); l.innerText='Введите номер (9XXXXXXXXX)'; i.placeholder='999...'; }
            document.getElementById('add-input-container').style.display='block';
        }

        window.addEventListener('load', () => {
            const user = tg.initDataUnsafe.user;
            if(user) {
                document.getElementById('user-name').innerText = user.first_name;
                if(user.photo_url) document.getElementById('user-avatar').innerHTML = `<img src="${user.photo_url}" style="width:100%; height:100%; border-radius:50%;">`;
                else document.getElementById('user-avatar').innerText = user.first_name[0];
            }
            updateStatus(); setInterval(updateStatus, 60000);
            loadData();
        });
    </script>
</body>
</html>                <div class="selectable" id="card-num" style="font-family:monospace; font-size:20px; letter-spacing:2px; margin-top:4px;">****</div>
                </div>
                <div style="display:flex; justify-content:space-between;">
                    <div><div style="font-size:12px; color:#888;">Баланс</div><div id="card-bal" style="font-size:16px; font-weight:600;">0.00 ₽</div></div>
                    <div><div style="font-size:12px; color:#888;">CVV</div><div class="selectable" id="card-cvv" style="font-size:16px; font-weight:600;">***</div></div>
                </div>
                <div style="margin-top:15px; border-top:1px solid rgba(255,255,255,0.1); padding-top:10px; font-size:12px; color:#666;">Активация: <span id="card-date">--.--.--</span></div>
            </div>
            <button class="action-btn btn-outline" onclick="showApiToken()">Показать API токен</button>
        </div>

        <!-- ПОДПИСКА -->
        <div id="page-sub" class="page page-hidden-right">
            <header>
                <div class="back-btn" onclick="goBack()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>Назад</div>
                <h1>Подписка</h1>
            </header>
            <div class="glass-card" style="text-align:center;">
                <div style="font-size:40px; margin-bottom:10px;">💎</div>
                <div style="font-size:14px; color:var(--text-sec);">Текущая подписка</div>
                <div id="user-sub-name" style="font-size:24px; font-weight:700; color:var(--primary); margin:10px 0;">...</div>
            </div>
        </div>

    </div>

    

        window.addEventListener('load', () => {
            const user = tg.initDataUnsafe.user;
            if(user) {
                document.getElementById('user-name').innerText = user.first_name;
                if(user.photo_url) document.getElementById('user-avatar').innerHTML = `<img src="${user.photo_url}" style="width:100%; height:100%; border-radius:50%;">`;
                else document.getElementById('user-avatar').innerText = user.first_name[0];
            }
            updateStatus(); setInterval(updateStatus, 60000);
            loadData();
        });
    </script>
</body>
</html>
